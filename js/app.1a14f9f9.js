(function(e){function t(t){for(var s,i,a=t[0],c=t[1],u=t[2],f=0,d=[];f<a.length;f++)i=a[f],r[i]&&d.push(r[i][0]),r[i]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(e[s]=c[s]);l&&l(t);while(d.length)d.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],s=!0,a=1;a<n.length;a++){var c=n[a];0!==r[c]&&(s=!1)}s&&(o.splice(t--,1),e=i(i.s=n[0]))}return e}var s={},r={app:0},o=[];function i(t){if(s[t])return s[t].exports;var n=s[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=s,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(n,s,function(t){return e[t]}.bind(null,s));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/vue-serenissima-editor/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var u=0;u<a.length;u++)t(a[u]);var l=c;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"05ae":function(e,t,n){},"09a0":function(e,t,n){},2295:function(e,t,n){e.exports={textColor:"#212529"}},"26b6":function(e,t,n){"use strict";var s=n("b265"),r=n.n(s);r.a},4566:function(e,t,n){"use strict";var s=n("75e5"),r=n.n(s);r.a},"53ef":function(e,t,n){"use strict";var s=n("d90e"),r=n.n(s);r.a},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var s=n("2b0e"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vse__app"},[n("editor")],1)},o=[],i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:["vse__editor",{"vse__editor--sidebar-is-open":e.$store.state.sidebarIsOpen}]},[n("div",{staticClass:"vse__main-wrapper"},[n("div",{staticClass:"vse__main"},[n("div",{staticClass:"vse__score-wrapper"},[n(e.$store.state.scoreMode,{tag:"component",attrs:{score:e.$store.state.score,"font-size":this.$store.state.fontSize,"font-size-unit":this.$store.state.fontSizeUnit}})],1),n("div",{staticClass:"vse__footer"},[n("console"),n("gui",{staticClass:"vse__gui"})],1)])]),n("sidebar",{staticClass:"vse__aside"})],1)},a=[],c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vse__score-font",style:{fontSize:e.$store.getters.getFontSize}},[e._v(e._s(e.score))])},u=[],l={props:{score:{type:String,default:""}}},f=l,d=(n("53ef"),n("2877")),v=Object(d["a"])(f,c,u,!1,null,"70369cde",null),h=v.exports,p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vse__score-canvas-wrapper"},[n("canvas",{ref:"scoreCanvas",staticClass:"vse__score-canvas"})])},_=[],m=(n("c5f6"),n("2295")),g=n.n(m),b=function(e,t,n,s){var r=e.getContext("2d");n=n||e.clientWidth,s=s||"5rem",S(r,n,t),C(r),r.font="".concat(s," Serenissima"),r.textBaseline="top",r.fillStyle=g.a.textColor,w(r,t,0,0,z(r),n)},C=function(e){var t=x(e);e.clearRect(0,0,e.canvas.width,e.canvas.height),e.setTransform(t,0,0,t,0,0)},S=function(e,t,n){var s=x(e),r=y(e,n,t);e.canvas.width=t*s,e.canvas.height=r*s,e.canvas.style.width=t+"px",e.canvas.style.height=r+"px"},y=function(e,t,n){return k(e,t,n)*z(e)},x=function(e){var t=window.devicePixelRatio||1,n=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return t/n},w=function e(t,n,s,r,o,i){if(i=i||0,i<=0)t.fillText(n,s,r);else{for(var a=1;a<=n.length;a++){var c=n.substr(0,a);if(t.measureText(c).width>i)return t.fillText(n.substr(0,a-1),s,r),void e(t,n.substr(a-1),s,r+o,o,i)}t.fillText(n,s,r)}},k=function e(t,n,s){for(var r=1,o=1;o<=n.length;o++){var i=n.substr(0,o);if(t.measureText(i).width>s)return r+e(t,n.substr(o-1),s)}return r},z=function(e){var t=10/49;return e.measureText("C3").width/t},$={props:{score:{type:String,default:""},fontSize:{type:Number,default:5},fontSizeUnit:{type:String,default:"rem"}},data:function(){return{context:null}},computed:{getFontSize:function(){return this.fontSize+this.fontSizeUnit}},watch:{score:function(){b(this.$refs.scoreCanvas,this.score)},getFontSize:function(){b(this.$refs.scoreCanvas,this.score,null,this.getFontSize)}},mounted:function(){b(this.$refs.scoreCanvas,this.score,this.$el.clientWidth,this.getFontSize),window.addEventListener("resize",this.onResize)},destroyed:function(){window.removeEventListener("resize",this.onResize)},methods:{onResize:function(){b(this.$refs.scoreCanvas,this.score,this.$el.clientWidth,this.getFontSize)}}},O=$,E=(n("cd85"),Object(d["a"])(O,p,_,!1,null,"53dda0b7",null)),j=E.exports,F=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vse__console"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.score,expression:"score"}],staticClass:"vse__input",attrs:{rows:"1"},domProps:{value:e.score},on:{input:function(t){t.target.composing||(e.score=t.target.value)}}})])},P=[],R={computed:{score:{get:function(){return this.$store.state.score},set:function(e){this.$store.commit("setScore",e)}}}},M=R,T=(n("7c8c"),Object(d["a"])(M,F,P,!1,null,"192bc8f2",null)),K=T.exports,B=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("transition-group",{staticClass:"vse__gui",attrs:{name:"vse__key-list-transition"}},e._l(e.filteredKeyCodes,function(e){return n("key",{key:e,attrs:{"key-code":e}})}),1)},U=[],W=(n("f559"),n("4917"),n("6762"),n("2fdb"),n("ac6a"),n("75fc")),L=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vse__key",on:{click:e.add}},[n("div",{staticClass:"vse__preview"},[e._v(e._s(e.keyCode))]),n("kbd",[e._v(e._s(e.keyCode))])])},N=[],A={props:{keyCode:{type:String,required:!0}},methods:{add:function(){this.$store.commit("setScore",this.$store.state.score+this.keyCode)}}},q=A,G=(n("4566"),Object(d["a"])(q,L,N,!1,null,"fd25ee6c",null)),I=G.exports,D={components:{Key:I},data:function(){return{groups:{clefs:["C","F","G"],timeSignatures:["T"],notes:["1","2","3","4","5","6","7","8","q","w","e"],rests:["10","20","30","40","50","60","70","q0","w0","e0"],additions:["+","-","U","."],specialCharacters:["u","i","o","p","B","E","R","*"]},keyCodes:[{keyCode:"C",variants:["1","2","3","4"]},{keyCode:"F",variants:["4","3"]},{keyCode:"G",variants:["2","1"]},{keyCode:"T",variants:["1","2","3","4","5","6","7","8","9"]}].concat(Object(W["a"])(this.getForAllLines(["1","2","3","4","5","6","7","8","q","w","e"])),Object(W["a"])(this.getForAllLines(["10","20","30","40","50","60","70","q0","w0","e0"])),Object(W["a"])(this.getForAllLines(["+","-","U","."])),Object(W["a"])(this.getSpecialCharacters(["u","i","o","p","B","E","R","*"])))}},computed:{allKeyCodes:function(){var e=[];return this.keyCodes.forEach(function(t){e.push(t.keyCode),t.variants.forEach(function(n){e.push(t.keyCode+n)})}),e},filteredKeyCodes:function(){var e=this;if(""===this.$store.state.score)return this.allKeyCodes.filter(function(t){return e.groups.clefs.includes(t)});if(this.$store.state.score.match(/^(C|F|G)\d$/g))return this.allKeyCodes.filter(function(e){return e.startsWith("T")});var t=this.lastChar(),n=this.lastChar(2),s=[];return 2===n.length&&(s=this.allKeyCodes.filter(function(e){return n!==e&&e.startsWith(n)}),s.length)?s:1===t.length&&(s=this.allKeyCodes.filter(function(n){return t!==n&&(!(!isNaN(t)&&[].concat(Object(W["a"])(e.groups.clefs),Object(W["a"])(e.groups.timeSignatures)).includes(e.lastChar(2)[0]))&&(n.startsWith(t)&&"0"!==n[1]||n===t+"0"))}),s.length)?s:this.allKeyCodes.filter(function(t){return e.groups.notes.includes(t)})}},methods:{lastChar:function(e){return this.$store.state.score.substr(-e||-1)},getForAllLines:function(e){var t=[];return e.forEach(function(e){t.push({keyCode:e,variants:["z","s","x","d","c","f","v","g","b","h","n","j","m","k",","]})}),t},getSpecialCharacters:function(e){var t=[];return e.forEach(function(e){t.push({keyCode:e,variants:[]})}),t}}},J=D,H=(n("8a7a"),Object(d["a"])(J,B,U,!1,null,"17d3fbe8",null)),Q=H.exports,V=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("aside",{class:{"vse__sidebar--is-open":e.$store.state.sidebarIsOpen}},[n("div",{staticClass:"vse__sidebar-header"},[n("div",{staticClass:"vse__toggle-sidebar",on:{click:e.toggleSidebar}},[e._v("‚Üê")]),n("h1",[e._v("vue-serenissima-editor")])]),n("div",{staticClass:"vse__sidebar-body"},[n("div",{staticClass:"vse__static-keys-container"},[n("h2",[e._v("Static Symbols")]),n("div",{staticClass:"vse__static-keys"},e._l(e.specialCharacters,function(e){return n("key",{key:e,attrs:{"key-code":e}})}),1)]),n("div",{staticClass:"vse__settings"},[n("h2",[e._v("Settings")]),n("button",{on:{click:function(t){return e.$store.commit("setScoreMode","ScoreCanvas")}}},[e._v("Canvas")]),n("button",{on:{click:function(t){return e.$store.commit("setScoreMode","ScoreFont")}}},[e._v("Font")]),n("div",[e._v("\n                Font size: "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.fontSize,expression:"fontSize"}],attrs:{type:"text"},domProps:{value:e.fontSize},on:{input:function(t){t.target.composing||(e.fontSize=t.target.value)}}}),e._v("rem\n                "),n("button",{on:{click:function(t){e.fontSize+=.5}}},[e._v("+")]),n("button",{on:{click:function(t){e.fontSize-=.5}}},[e._v("-")])])]),n("div",{staticClass:"vse__export"},[n("h2",[e._v("Export")]),e._v("\n            Width: "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.width,expression:"width"}],attrs:{type:"text"},domProps:{value:e.width},on:{input:function(t){t.target.composing||(e.width=t.target.value)}}}),e._v("px\n            "),n("button",{on:{click:e.exportCanvasAsPng}},[e._v("Download PNG")])])]),e._m(0)])},X=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vse__sidebar-footer"},[e._v("\n        By Elam Rotem and Wolfgang Drescher\n        "),n("a",{attrs:{href:"https://www.earlymusicsources.com/more/font-serenissima",target:"_blank"}},[e._v("Early Music Sources")])])}],Y=(n("a481"),{components:{Key:I},data:function(){return{width:1280,exportCanvas:null,specialCharacters:["u","i","o","p","B","E","R","*"]}},computed:{fontSize:{get:function(){return this.$store.state.fontSize},set:function(e){return this.$store.commit("setFontSize",e)}},score:function(){return this.$store.state.score}},created:function(){this.exportCanvas=document.createElement("canvas")},mounted:function(){b(this.exportCanvas,this.score)},methods:{toggleSidebar:function(){this.$store.commit("toggleSidebar")},exportCanvasAsPng:function(){b(this.exportCanvas,this.score,this.width,this.$store.getters.getFontSize);var e=this.exportCanvas.toDataURL("image/png",1).replace("image/png","image/octet-stream"),t=document.createElement("a");t.download="score.png",t.href=e,t.click()}}}),Z=Y,ee=(n("26b6"),Object(d["a"])(Z,V,X,!1,null,"222c6495",null)),te=ee.exports,ne={components:{ScoreFont:h,ScoreCanvas:j,Console:K,Gui:Q,Sidebar:te}},se=ne,re=(n("8e28"),Object(d["a"])(se,i,a,!1,null,"660f7cef",null)),oe=re.exports,ie={components:{Editor:oe}},ae=ie,ce=(n("60fb"),Object(d["a"])(ae,r,o,!1,null,"49f34937",null)),ue=ce.exports,le=n("2f62");s["a"].use(le["a"]);var fe=new le["a"].Store({state:{fontSize:5,fontSizeUnit:"rem",score:"",sidebarIsOpen:!1,scoreMode:"ScoreCanvas"},mutations:{setScore:function(e,t){e.score=t},toggleSidebar:function(e){e.sidebarIsOpen=!e.sidebarIsOpen},toggleScoreMode:function(e){e.scoreMode="ScoreCanvas"===e.scoreMode?"ScoreFont":"ScoreCanvas"},setScoreMode:function(e,t){e.scoreMode=t},setFontSize:function(e,t){e.fontSize=t}},getters:{getFontSize:function(e){return e.fontSize+e.fontSizeUnit}}});n("b751");s["a"].config.productionTip=!1;var de=new s["a"]({store:fe,render:function(e){return e(ue)}});de.$mount("#app")},"60fb":function(e,t,n){"use strict";var s=n("8315"),r=n.n(s);r.a},"75e5":function(e,t,n){},"7c8c":function(e,t,n){"use strict";var s=n("ff7a"),r=n.n(s);r.a},8315:function(e,t,n){},"8a7a":function(e,t,n){"use strict";var s=n("05ae"),r=n.n(s);r.a},"8e28":function(e,t,n){"use strict";var s=n("b1a5"),r=n.n(s);r.a},b1a5:function(e,t,n){},b265:function(e,t,n){},b751:function(e,t,n){},cd85:function(e,t,n){"use strict";var s=n("09a0"),r=n.n(s);r.a},d90e:function(e,t,n){},ff7a:function(e,t,n){}});
//# sourceMappingURL=app.1a14f9f9.js.map